# =============================================================================
# Docker Compose ‚Äî Orchestration multi-conteneurs
# =============================================================================
#
# üìñ QU'EST-CE QUE DOCKER COMPOSE ?
#
# Docker Compose est un outil pour d√©finir et ex√©cuter des applications Docker
# multi-conteneurs. Avec Compose, vous utilisez un fichier YAML pour configurer
# les services de votre application.
#
# ‚úÖ AVANTAGES :
#   - D√©finition d√©clarative de l'infrastructure
#   - Gestion simplifi√©e des d√©pendances entre services
#   - Environnements reproductibles (dev = prod)
#   - Isolation des services (r√©seau, volumes)
#   - Scalabilit√© facile (docker compose up --scale web=3)
#
# üîß INSTALLATION :
#   Docker Desktop (Windows/Mac) : Compose inclus
#   Linux : sudo apt install docker-compose-plugin
#   V√©rifier : docker compose version
#
# üöÄ COMMANDES PRINCIPALES :
#   docker compose up          # D√©marrer tous les services
#   docker compose up -d       # D√©marrer en arri√®re-plan (detached)
#   docker compose down        # Arr√™ter et supprimer conteneurs
#   docker compose ps          # Lister les services actifs
#   docker compose logs -f     # Suivre les logs en temps r√©el
#   docker compose exec web sh # Ex√©cuter commande dans conteneur
#   docker compose build       # Construire/reconstruire images
#   docker compose restart     # Red√©marrer services
#
# üìç FICHIERS COMPOSE :
#   - docker-compose.yml       : Configuration par d√©faut
#   - docker-compose.override.yml : Surcharges locales (dev)
#   - docker-compose.prod.yml  : Configuration production
#   - .env                     : Variables d'environnement
#
# üìö DOCUMENTATION :
#   - Docs officielles : https://docs.docker.com/compose/
#   - Compose file reference : https://docs.docker.com/compose/compose-file/
#   - Best practices : https://docs.docker.com/develop/dev-best-practices/
#
# =============================================================================

# Version de la syntaxe Docker Compose
# 3.8 : compatible Docker Engine 19.03.0+ (recommand√©)
# Autres versions : 2.x (legacy), 3.9 (latest stable)
version: '3.8'

# =============================================================================
# üåê R√âSEAUX (Networks)
# =============================================================================
#
# Les r√©seaux permettent l'isolation et la communication entre conteneurs.
#
# TYPES DE R√âSEAUX :
#   - bridge : r√©seau par d√©faut, conteneurs sur m√™me h√¥te
#   - host : utilise directement le r√©seau de l'h√¥te (performance)
#   - overlay : multi-h√¥te (Docker Swarm)
#   - none : aucun r√©seau
#
# üí° BONNES PRATIQUES :
#   - Cr√©er r√©seaux s√©par√©s pour groupes de services (frontend, backend, db)
#   - Ne jamais exposer directement base de donn√©es sur r√©seau public
#   - Utiliser DNS int√©gr√© : services communiquent via nom (ex: http://api:3000)
#
networks:
  # R√©seau frontend : web, nginx, services publics
  frontend:
    driver: bridge
    driver_opts:
      com.docker.network.bridge.name: frontend_bridge
    ipam:
      driver: default
      config:
        - subnet: 172.20.0.0/16  # Plage IP personnalis√©e

  # R√©seau backend : API, microservices
  backend:
    driver: bridge
    driver_opts:
      com.docker.network.bridge.name: backend_bridge
    ipam:
      driver: default
      config:
        - subnet: 172.21.0.0/16

  # R√©seau database : DB, cache (isol√© du public)
  database:
    driver: bridge
    internal: true  # Pas d'acc√®s externe (s√©curit√©)
    driver_opts:
      com.docker.network.bridge.name: db_bridge
    ipam:
      driver: default
      config:
        - subnet: 172.22.0.0/16

# =============================================================================
# üíæ VOLUMES (Persistent Storage)
# =============================================================================
#
# Les volumes permettent de persister les donn√©es au-del√† du cycle de vie
# des conteneurs.
#
# TYPES DE VOLUMES :
#   - Named volumes : g√©r√©s par Docker (recommand√© pour production)
#   - Bind mounts : montage dossier h√¥te (dev, fichiers config)
#   - tmpfs : m√©moire temporaire (pas de persistence)
#
# üí° BONNES PRATIQUES :
#   - Utiliser volumes nomm√©s pour donn√©es critiques (DB, uploads)
#   - Bind mounts pour code source en d√©veloppement (hot reload)
#   - Backup r√©gulier : docker run --rm -v db_data:/data -v $(pwd):/backup alpine tar czf /backup/backup.tar.gz /data
#
volumes:
  # Volume PostgreSQL : donn√©es de la base
  postgres_data:
    driver: local
    driver_opts:
      type: none
      o: bind
      device: ./volumes/postgres  # Chemin sur h√¥te (dev)
    # Production : utiliser volume Docker natif
    # driver: local (sans driver_opts)

  # Volume Redis : cache et sessions
  redis_data:
    driver: local

  # Volume uploads : fichiers utilisateurs
  app_uploads:
    driver: local
    driver_opts:
      type: none
      o: bind
      device: ./volumes/uploads

  # Volume logs : journaux applicatifs
  app_logs:
    driver: local

  # Volume Elasticsearch : index de recherche
  elasticsearch_data:
    driver: local

# =============================================================================
# üê≥ SERVICES (Containers)
# =============================================================================
#
# Chaque service repr√©sente un conteneur dans l'application.
#
# STRUCTURE D'UN SERVICE :
#   - image/build : source de l'image Docker
#   - ports : mapping ports h√¥te:conteneur
#   - environment : variables d'environnement
#   - volumes : montage de volumes
#   - networks : r√©seaux √† rejoindre
#   - depends_on : d√©pendances de d√©marrage
#   - restart : politique de red√©marrage
#   - healthcheck : v√©rifications de sant√©
#
services:

  # ===========================================================================
  # üóÑÔ∏è BASE DE DONN√âES ‚Äî PostgreSQL
  # ===========================================================================
  postgres:
    # Image officielle PostgreSQL (version Alpine = plus l√©g√®re)
    image: postgres:16-alpine
    
    # Nom personnalis√© du conteneur (optionnel mais recommand√©)
    container_name: enseignement_postgres
    
    # Politique de red√©marrage
    # - no : jamais red√©marrer automatiquement
    # - always : toujours red√©marrer
    # - on-failure : red√©marrer seulement si √©chec
    # - unless-stopped : toujours red√©marrer sauf si arr√™t manuel
    restart: unless-stopped
    
    # Variables d'environnement
    # üí° S√âCURIT√â : utiliser fichier .env pour valeurs sensibles
    environment:
      # Utilisateur et mot de passe PostgreSQL
      POSTGRES_USER: ${POSTGRES_USER:-postgres}
      POSTGRES_PASSWORD: ${POSTGRES_PASSWORD:-changeme}
      POSTGRES_DB: ${POSTGRES_DB:-app_database}
      
      # Configuration PostgreSQL
      POSTGRES_INITDB_ARGS: "--encoding=UTF8 --locale=fr_FR.UTF-8"
      PGDATA: /var/lib/postgresql/data/pgdata
      
      # Timezone
      TZ: Europe/Paris
    
    # Ports expos√©s (h√¥te:conteneur)
    # ‚ö†Ô∏è PRODUCTION : ne pas exposer directement (utiliser r√©seau interne)
    ports:
      - "${POSTGRES_PORT:-5432}:5432"
    
    # Volumes pour persistence
    volumes:
      # Donn√©es PostgreSQL (persistence)
      - postgres_data:/var/lib/postgresql/data
      
      # Scripts d'initialisation (ex√©cut√©s au premier d√©marrage)
      - ./init-scripts/postgres:/docker-entrypoint-initdb.d:ro
      
      # Configuration personnalis√©e (optionnel)
      # - ./postgres.conf:/etc/postgresql/postgresql.conf:ro
    
    # R√©seaux
    networks:
      - database
      - backend  # Acc√®s depuis services backend
    
    # Healthcheck : v√©rifier que PostgreSQL est pr√™t
    healthcheck:
      test: ["CMD-SHELL", "pg_isready -U ${POSTGRES_USER:-postgres}"]
      interval: 10s      # V√©rifier toutes les 10 secondes
      timeout: 5s        # Timeout apr√®s 5 secondes
      retries: 5         # 5 tentatives avant √©chec
      start_period: 30s  # D√©lai initial avant premiers checks
    
    # Limites de ressources (optionnel mais recommand√©)
    deploy:
      resources:
        limits:
          cpus: '1.0'      # Max 1 CPU
          memory: 1G       # Max 1 Go RAM
        reservations:
          cpus: '0.5'      # Min 0.5 CPU
          memory: 512M     # Min 512 Mo RAM

  # ===========================================================================
  # üî¥ CACHE ‚Äî Redis
  # ===========================================================================
  redis:
    image: redis:7-alpine
    container_name: enseignement_redis
    restart: unless-stopped
    
    # Commande de d√©marrage avec configuration
    command: >
      redis-server
      --requirepass ${REDIS_PASSWORD:-changeme}
      --maxmemory 256mb
      --maxmemory-policy allkeys-lru
      --appendonly yes
      --appendfsync everysec
    
    environment:
      TZ: Europe/Paris
    
    ports:
      - "${REDIS_PORT:-6379}:6379"
    
    volumes:
      # Persistence Redis (AOF)
      - redis_data:/data
      
      # Configuration personnalis√©e (optionnel)
      # - ./redis.conf:/usr/local/etc/redis/redis.conf:ro
    
    networks:
      - backend
      - database
    
    healthcheck:
      test: ["CMD", "redis-cli", "--raw", "incr", "ping"]
      interval: 10s
      timeout: 3s
      retries: 5
      start_period: 20s
    
    deploy:
      resources:
        limits:
          cpus: '0.5'
          memory: 512M
        reservations:
          cpus: '0.25'
          memory: 256M

  # ===========================================================================
  # üîç RECHERCHE ‚Äî Elasticsearch
  # ===========================================================================
  elasticsearch:
    image: docker.elastic.co/elasticsearch/elasticsearch:8.11.0
    container_name: enseignement_elasticsearch
    restart: unless-stopped
    
    environment:
      # Mode single-node (dev) ou cluster (prod)
      discovery.type: single-node
      
      # S√©curit√© (d√©sactiver pour dev, activer pour prod)
      xpack.security.enabled: false
      xpack.security.enrollment.enabled: false
      
      # Limites m√©moire JVM
      ES_JAVA_OPTS: "-Xms512m -Xmx512m"
      
      # Timezone
      TZ: Europe/Paris
    
    ports:
      - "${ELASTICSEARCH_PORT:-9200}:9200"
      - "9300:9300"  # Port cluster
    
    volumes:
      - elasticsearch_data:/usr/share/elasticsearch/data
    
    networks:
      - backend
    
    healthcheck:
      test: ["CMD-SHELL", "curl -f http://localhost:9200/_cluster/health || exit 1"]
      interval: 30s
      timeout: 10s
      retries: 5
      start_period: 60s
    
    deploy:
      resources:
        limits:
          cpus: '1.0'
          memory: 1G
        reservations:
          cpus: '0.5'
          memory: 512M
    
    # Configuration ulimits (requis pour Elasticsearch)
    ulimits:
      memlock:
        soft: -1
        hard: -1
      nofile:
        soft: 65536
        hard: 65536

  # ===========================================================================
  # üåê API BACKEND ‚Äî Node.js / Python / etc.
  # ===========================================================================
  api:
    # Construction depuis Dockerfile
    build:
      context: ../backend  # Chemin vers code source
      dockerfile: Dockerfile
      # Arguments de build (disponibles dans Dockerfile via ARG)
      args:
        NODE_ENV: ${NODE_ENV:-development}
        BUILD_DATE: ${BUILD_DATE:-2025-12-09}
        VERSION: ${APP_VERSION:-1.0.0}
      # Cache pour acc√©l√©rer builds
      cache_from:
        - enseignement_api:latest
    
    # Nom du conteneur
    container_name: enseignement_api
    
    # Image finale (tag apr√®s build)
    image: enseignement_api:latest
    
    restart: unless-stopped
    
    # Variables d'environnement (depuis .env)
    environment:
      NODE_ENV: ${NODE_ENV:-development}
      PORT: 3000
      
      # Database
      DATABASE_URL: postgresql://${POSTGRES_USER}:${POSTGRES_PASSWORD}@postgres:5432/${POSTGRES_DB}
      
      # Redis
      REDIS_URL: redis://:${REDIS_PASSWORD}@redis:6379
      
      # Elasticsearch
      ELASTICSEARCH_URL: http://elasticsearch:9200
      
      # Security
      SECRET_KEY: ${SECRET_KEY}
      JWT_SECRET: ${JWT_SECRET}
      
      # CORS
      CORS_ORIGIN: ${CORS_ORIGIN:-http://localhost:5173}
      
      # Timezone
      TZ: Europe/Paris
    
    # Fichier .env alternatif (optionnel)
    # env_file:
    #   - .env
    #   - .env.local
    
    ports:
      - "${API_PORT:-3000}:3000"
    
    volumes:
      # Code source (hot reload en dev)
      - ../backend:/app:cached
      
      # node_modules depuis conteneur (√©viter conflits)
      - /app/node_modules
      
      # Uploads
      - app_uploads:/app/uploads
      
      # Logs
      - app_logs:/app/logs
    
    networks:
      - frontend
      - backend
      - database
    
    # D√©pendances : attendre que services soient pr√™ts
    depends_on:
      postgres:
        condition: service_healthy
      redis:
        condition: service_healthy
      elasticsearch:
        condition: service_healthy
    
    # Commande de d√©marrage (surcharge CMD du Dockerfile)
    # Dev : nodemon pour hot reload
    # Prod : node server.js
    command: npm run dev
    
    healthcheck:
      test: ["CMD", "wget", "--no-verbose", "--tries=1", "--spider", "http://localhost:3000/health"]
      interval: 30s
      timeout: 10s
      retries: 3
      start_period: 40s
    
    deploy:
      resources:
        limits:
          cpus: '1.0'
          memory: 1G
        reservations:
          cpus: '0.5'
          memory: 512M
    
    # Variables d'environnement suppl√©mentaires (debug)
    # stdin_open: true  # √âquivalent docker run -i
    # tty: true         # √âquivalent docker run -t

  # ===========================================================================
  # ‚öõÔ∏è FRONTEND ‚Äî React / Vue / Angular
  # ===========================================================================
  frontend:
    build:
      context: ../frontend
      dockerfile: Dockerfile
      target: development  # Multi-stage : development ou production
      args:
        VITE_API_URL: ${VITE_API_URL:-http://localhost:3000}
    
    container_name: enseignement_frontend
    image: enseignement_frontend:latest
    restart: unless-stopped
    
    environment:
      NODE_ENV: ${NODE_ENV:-development}
      VITE_API_URL: ${VITE_API_URL:-http://localhost:3000}
      TZ: Europe/Paris
    
    ports:
      - "${FRONTEND_PORT:-5173}:5173"
    
    volumes:
      # Code source (hot reload)
      - ../frontend:/app:cached
      - /app/node_modules
      
      # Build output (production)
      # - ../frontend/dist:/app/dist
    
    networks:
      - frontend
    
    depends_on:
      - api
    
    command: npm run dev -- --host
    
    # Pas de healthcheck pour dev server Vite (optionnel)
    # healthcheck:
    #   test: ["CMD", "wget", "--spider", "http://localhost:5173"]
    #   interval: 30s
    #   timeout: 10s
    #   retries: 3

  # ===========================================================================
  # üîÑ REVERSE PROXY ‚Äî Nginx
  # ===========================================================================
  nginx:
    image: nginx:alpine
    container_name: enseignement_nginx
    restart: unless-stopped
    
    ports:
      - "${NGINX_HTTP_PORT:-80}:80"
      - "${NGINX_HTTPS_PORT:-443}:443"
    
    volumes:
      # Configuration Nginx
      - ./nginx/nginx.conf:/etc/nginx/nginx.conf:ro
      - ./nginx/conf.d:/etc/nginx/conf.d:ro
      
      # Certificats SSL/TLS
      - ./nginx/certs:/etc/nginx/certs:ro
      
      # Static files
      - ../frontend/dist:/usr/share/nginx/html:ro
      
      # Logs
      - ./nginx/logs:/var/log/nginx
    
    networks:
      - frontend
    
    depends_on:
      - api
      - frontend
    
    healthcheck:
      test: ["CMD", "wget", "--quiet", "--tries=1", "--spider", "http://localhost/health"]
      interval: 30s
      timeout: 10s
      retries: 3
    
    deploy:
      resources:
        limits:
          cpus: '0.5'
          memory: 256M

  # ===========================================================================
  # üìä MONITORING ‚Äî Prometheus + Grafana (optionnel)
  # ===========================================================================
  
  # prometheus:
  #   image: prom/prometheus:latest
  #   container_name: enseignement_prometheus
  #   restart: unless-stopped
  #   
  #   ports:
  #     - "9090:9090"
  #   
  #   volumes:
  #     - ./prometheus/prometheus.yml:/etc/prometheus/prometheus.yml:ro
  #     - prometheus_data:/prometheus
  #   
  #   command:
  #     - '--config.file=/etc/prometheus/prometheus.yml'
  #     - '--storage.tsdb.path=/prometheus'
  #     - '--web.console.libraries=/usr/share/prometheus/console_libraries'
  #     - '--web.console.templates=/usr/share/prometheus/consoles'
  #   
  #   networks:
  #     - backend

  # grafana:
  #   image: grafana/grafana:latest
  #   container_name: enseignement_grafana
  #   restart: unless-stopped
  #   
  #   ports:
  #     - "3001:3000"
  #   
  #   environment:
  #     GF_SECURITY_ADMIN_USER: ${GRAFANA_USER:-admin}
  #     GF_SECURITY_ADMIN_PASSWORD: ${GRAFANA_PASSWORD:-admin}
  #     GF_INSTALL_PLUGINS: grafana-clock-panel
  #   
  #   volumes:
  #     - grafana_data:/var/lib/grafana
  #     - ./grafana/dashboards:/etc/grafana/provisioning/dashboards:ro
  #     - ./grafana/datasources:/etc/grafana/provisioning/datasources:ro
  #   
  #   networks:
  #     - backend
  #   
  #   depends_on:
  #     - prometheus

  # ===========================================================================
  # üìß MAIL SERVER ‚Äî Mailhog (dev) ou SMTP (prod)
  # ===========================================================================
  
  # mailhog:
  #   image: mailhog/mailhog:latest
  #   container_name: enseignement_mailhog
  #   restart: unless-stopped
  #   
  #   ports:
  #     - "1025:1025"  # SMTP
  #     - "8025:8025"  # Web UI
  #   
  #   networks:
  #     - backend

  # ===========================================================================
  # üîß ADMINER ‚Äî Interface DB (dev uniquement)
  # ===========================================================================
  
  # adminer:
  #   image: adminer:latest
  #   container_name: enseignement_adminer
  #   restart: unless-stopped
  #   
  #   ports:
  #     - "8080:8080"
  #   
  #   environment:
  #     ADMINER_DEFAULT_SERVER: postgres
  #     ADMINER_DESIGN: pepa-linha
  #   
  #   networks:
  #     - database
  #     - frontend
  #   
  #   depends_on:
  #     - postgres

# =============================================================================
# üìù NOTES ET BONNES PRATIQUES
# =============================================================================
#
# S√âCURIT√â
#   ‚úÖ Utiliser .env pour valeurs sensibles (mots de passe, cl√©s API)
#   ‚úÖ Ajouter .env dans .gitignore
#   ‚úÖ Cr√©er .env.example avec valeurs factices
#   ‚úÖ Ne jamais exposer DB directement (r√©seau internal)
#   ‚úÖ Utiliser secrets Docker pour production (docker secret create)
#   ‚úÖ Mettre √† jour r√©guli√®rement les images (vuln√©rabilit√©s)
#   ‚úÖ Scanner images : docker scan <image>
#   ‚ö†Ô∏è √âviter latest en production (pr√©f√©rer tags versionn√©s)
#
# PERFORMANCE
#   ‚úÖ Utiliser images Alpine (plus l√©g√®res)
#   ‚úÖ Multi-stage builds (r√©duire taille images)
#   ‚úÖ Limiter ressources (deploy.resources)
#   ‚úÖ Utiliser cache Docker (COPY package.json avant COPY .)
#   ‚úÖ Volumes cached pour bind mounts (macOS)
#   ‚úÖ Ne pas bind mount node_modules (conflits)
#   ‚ö†Ô∏è Healthchecks : balance fr√©quence vs overhead
#
# D√âVELOPPEMENT
#   ‚úÖ Hot reload : bind mount code source
#   ‚úÖ Override : docker-compose.override.yml (auto-charg√©)
#   ‚úÖ Logs : docker compose logs -f <service>
#   ‚úÖ Shell : docker compose exec <service> sh
#   ‚úÖ Rebuild : docker compose up --build
#   ‚úÖ Clean : docker compose down -v (supprime volumes)
#   üí° Profils : grouper services optionnels
#
# PRODUCTION
#   ‚úÖ Variables d'environnement : secrets, config externe
#   ‚úÖ Healthchecks : monitoring automatique
#   ‚úÖ Restart policies : unless-stopped ou always
#   ‚úÖ Limites ressources : √©viter OOM
#   ‚úÖ Logging : drivers externes (Fluentd, Splunk)
#   ‚úÖ Backups : volumes, bases de donn√©es
#   ‚úÖ SSL/TLS : certificats Let's Encrypt
#   ‚ö†Ô∏è Docker Swarm ou Kubernetes pour orchestration avanc√©e
#
# D√âPENDANCES (depends_on)
#   ‚ö†Ô∏è depends_on attend d√©marrage, PAS que service soit pr√™t
#   ‚úÖ Utiliser condition: service_healthy avec healthcheck
#   ‚úÖ Impl√©menter retry logic dans application
#   üí° Ordre de d√©marrage : DB ‚Üí Cache ‚Üí API ‚Üí Frontend ‚Üí Nginx
#
# R√âSEAUX
#   ‚úÖ Isoler services sensibles (DB sur r√©seau internal)
#   ‚úÖ Services communiquent via nom (ex: postgres, redis)
#   ‚úÖ DNS int√©gr√© : r√©solution automatique
#   üí° Ne pas exposer tous les ports (utiliser nginx comme gateway)
#
# VOLUMES
#   ‚úÖ Named volumes : donn√©es persistantes (DB, uploads)
#   ‚úÖ Bind mounts : d√©veloppement (hot reload)
#   ‚úÖ Backup r√©gulier : docker run --rm -v <volume>:/data alpine tar czf
#   ‚ö†Ô∏è Permissions : attention UID/GID conteneur vs h√¥te
#   üí° Volumes driver local vs NFS vs cloud (AWS EFS, Azure Files)
#
# COMMANDES AVANC√âES
#   docker compose up -d --scale api=3  # Scaler service
#   docker compose config                # Valider syntaxe
#   docker compose top                   # Voir processus actifs
#   docker compose images                # Lister images utilis√©es
#   docker compose port api 3000         # Port publi√©
#   docker compose pause / unpause       # Suspendre/reprendre
#
# PROFILS (optionnel, Compose v1.28+)
#   Grouper services optionnels :
#     services:
#       debug:
#         profiles: ["debug"]
#   Activer : docker compose --profile debug up
#
# EXTENDS (r√©utilisation configuration)
#   services:
#     web:
#       extends:
#         file: common.yml
#         service: app
#
# FICHIERS MULTIPLES
#   docker compose -f docker-compose.yml -f docker-compose.prod.yml up
#   Ordre important : derniers fichiers surchargent premiers
#
# VARIABLES D'ENVIRONNEMENT
#   Priorit√© : 1. Shell, 2. .env, 3. Compose file, 4. Dockerfile
#   Syntaxe : ${VAR:-default}, ${VAR:?error}, ${VAR}
#
# =============================================================================
#
# üîç DEBUGGING
#
# Service ne d√©marre pas :
#   1. docker compose logs <service>
#   2. docker compose exec <service> sh (si running)
#   3. V√©rifier healthcheck : docker compose ps
#   4. V√©rifier r√©seau : docker compose exec <service> ping <autre_service>
#   5. V√©rifier variables : docker compose config
#
# Probl√®mes r√©seau :
#   - Services ne communiquent pas : v√©rifier networks
#   - DNS ne r√©sout pas : utiliser noms de services (pas IPs)
#   - Port d√©j√† utilis√© : changer port h√¥te (8080:80)
#
# Probl√®mes volumes :
#   - Donn√©es perdues : v√©rifier volumes nomm√©s
#   - Permissions denied : changer UID/GID ou volumes
#   - Bind mount vide : v√©rifier chemins relatifs
#
# Probl√®mes performance :
#   - Lent sur macOS : utiliser cached/delegated
#   - OOM : augmenter limites m√©moire
#   - CPU √©lev√© : v√©rifier healthchecks trop fr√©quents
#
# =============================================================================
#
# üìö RESSOURCES
#
# Documentation officielle :
#   - Docker Compose : https://docs.docker.com/compose/
#   - Compose file v3 : https://docs.docker.com/compose/compose-file/compose-file-v3/
#   - CLI reference : https://docs.docker.com/compose/reference/
#
# Best practices :
#   - Docker : https://docs.docker.com/develop/dev-best-practices/
#   - Production : https://docs.docker.com/compose/production/
#   - Security : https://docs.docker.com/engine/security/
#
# Exemples de projets :
#   - Awesome Compose : https://github.com/docker/awesome-compose
#   - Real-world apps : https://github.com/gothinkster/realworld
#
# Outils compl√©mentaires :
#   - Portainer : UI pour g√©rer conteneurs
#   - Lazydocker : TUI (terminal UI)
#   - Dive : analyser taille images
#   - Hadolint : linter pour Dockerfiles
#
# =============================================================================
#
# üöÄ UTILISATION RAPIDE
#
# D√©marrer tous les services :
#   docker compose up -d
#
# Voir les logs :
#   docker compose logs -f
#   docker compose logs -f api  # Service sp√©cifique
#
# Arr√™ter :
#   docker compose down
#   docker compose down -v  # + supprimer volumes
#
# Rebuild apr√®s changement code :
#   docker compose up --build
#
# Acc√©der √† un conteneur :
#   docker compose exec api sh
#   docker compose exec postgres psql -U postgres
#
# Red√©marrer un service :
#   docker compose restart api
#
# Voir statut :
#   docker compose ps
#
# =============================================================================
#
# Version de ce fichier : 1.0
# Derni√®re mise √† jour : 9 d√©cembre 2025
# Mainteneur : WyloW2Ricard0
# Licence : CC0 (Domaine Public) ‚Äî Adaptez librement
#
# =============================================================================
